# 「等等要吃啥」產品需求文件（PRD）

## 1. 產品簡介

- **產品名稱**：等等要吃啥（Wait, What to Eat）
- **一句話價值主張**：用 Google Map 取得你附近的高評價餐廳，替你**隨機（但更懂你）**選一家，按下就去吃。
- **目標用戶**：在台灣（先從大台北）常為「要吃什麼」猶豫不決的學生、上班族、情侶、小團體。
- **平台範圍（MVP）**：Android / iOS（React Native 或 Flutter 擇一）、雲端後端（Node.js / Deno）、資料庫（Supabase Postgres）。

## 2. 產品目標（MVP）

1. 10 秒內完成一次「附近 → 篩選 → 隨機挑店」流程。
2. 相同條件下連抽 3 次，不重複同一家店（除非使用者要求）。
3. 初次開啟 30 秒內完成定位、授權、第一家推薦。
4. NPS ≥ 40；一週留存率（W1）≥ 25%。

## 3. 主要使用情境 / User Stories

- **US-01（立刻吃）**：作為上班族，我在午餐時間只有 10 分鐘決定，要打開 App，讓它在 5 秒內幫我抽一家評價高、人均價格合適、正在營業的餐廳。
- **US-02（一起決定）**：作為情侶/朋友，我想用「輪盤抽籤 / 搖一搖」跟伴侶一起決定，避免選擇困難。
- **US-03（避免雷店）**：作為吃貨，我想排除我不吃的品類/黑名單，或只看 4.2 星以上且評論數 ≥ 100 的店。
- **US-04（方便導航）**：我想直接一鍵開啟 Google Maps 導航、電話訂位、查看營業時間與熱門時段。

## 4. 使用流程（MVP）

1. 首次啟動 → 同意條款 / 位置權限（精確定位）。
2. 自動抓取座標 → 呼叫 Google Places Nearby Search。
3. 套用預設篩選（評分、距離、營業中、價格帶）。
4. 權重隨機（見 §7 演算法）抽 1 家 → 展示卡片。
5. 使用者操作：
   - 接受 → 一鍵開 Google Maps 導航 / 打電話 / 複製地址。
   - 再抽一次 → 重新抽，但避免短時間內重複。
   - 調整條件 → 距離 / 價格 / 類別 / 營業中 / 外帶外送。
   - 加入最愛 / 加入黑名單。

## 5. 功能需求（Functional Requirements）

### 5.1 搜尋與資料取得

- 取得目前座標（高精度，退化至中精度）。
- Google Places API：
  - **Nearby Search**：依 location、radius、type/keyword、opennow、minprice~maxprice、language=zh-TW。
  - **Place Details**：補齊 rating、user_ratings_total、opening_hours、formatted_address、formatted_phone_number、price_level、photos、website。
  - **Photo**：展示首圖（壓縮快取）。
- 依地區/語系預設 language=zh-TW、距離以公尺、價格以 TWD 顯示。

### 5.2 篩選條件（MVP）

- 距離半徑：500m / 1km / 2km / 3km（預設 1km）。
- 評分下限：4.0 / 4.2 / 4.5（預設 4.2）。
- 評論數下限：50 / 100（預設 50）。
- 價格帶：$（便宜）~ $$$$（高價）多選（預設 $~$$$）。
- 營業狀態：只顯示「目前營業中」（預設開啟）。
- 類別：台式、小吃、咖啡、日式、韓式、義式、泰式、素食、早午餐、甜點等（多選）。
- 排除清單：黑名單店家 / 類別。

### 5.3 推薦卡片資訊

- 店名、主圖、星等、評論數、價格帶、標籤（類別）、營業狀態、距離、地址。
- 快捷按鈕：再抽一間、導航、打電話、查看評論、收藏、不喜歡。

### 5.4 歷史與偏好（本機 + 雲端）

- 最近抽過/去過店家（時間、條件、是否採納）。
- 偏好：常吃品類、常用價格帶、常用距離。
- 最愛與黑名單清單。

### 5.5 本地化與無障礙

- 語言：繁體中文（MVP），英文（V1）。
- 字體大小可調；語音播報（V1）。

## 6. 非功能需求（NFR）

- **效能**：搜尋→顯示第一家 ≤ 5 秒；再抽一次 ≤ 2 秒（命中快取時）。
- **穩定性**：API 失敗自動重試（指數退避 2 次）。
- **隱私**：位置資訊只做即時推薦；雲端僅保存經匿名化的聚合資料（可關閉）。
- **離線**：離線時提示「無法搜尋」，可瀏覽已收藏店家（若有快取圖片則顯示）。

## 7. 推薦演算法（草案）

1. 以預設或使用者設定的距離、評分、價格等條件向 Google Places 搜尋候選清單。
2. 將候選店家依以下權重計算推薦分數：
   - Google 評分（40%）。
   - 評論數標準化（20%）。
   - 與偏好類別匹配度（20%）。
   - 與價格偏好匹配度（10%）。
   - 與距離偏好匹配度（10%）。
3. 將近期已抽過的店家降權，避免短時間內重複。
4. 以加權隨機方式抽出推薦店家，並提供重新抽取的能力。

## 8. 指標追蹤（MVP）

- **轉換漏斗**：開啟 App → 首次推薦 → 點擊導航/電話。
- **互動指標**：再抽一次次數、條件調整次數、收藏/黑名單使用率。
- **留存指標**：W1 留存率、30 天內使用頻率。
- **滿意度**：NPS、App Store/Google Play 評價。

## 9. 待辦事項（後續版本）

- 推薦演算法 A/B 測試。
- 支援外送/外帶資訊整合（Uber Eats、foodpanda）。
- 加入社交分享與團體投票機制。
- 離線地圖與推薦快取。
- 多語系（英文 UI）、深色模式。

